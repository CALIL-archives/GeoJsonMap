// Generated by CoffeeScript 1.7.1
var app;

app = {
  geojsons: {},
  getGeoJSONByLevel: function(level) {
    var geojson;
    geojson = this.geojsons[level];
    geojson.haika = {
      xyLatitude: 35.1550682,
      xyLongitude: 136.9637741
    };
    return geojson;
  },
  loadGeoJSON: function(option) {
    return $.ajax({
      url: "http://lab.calil.jp/haika_store/load.php?major=" + option.major,
      type: 'GET',
      cache: false,
      dataType: 'json',
      error: (function(_this) {
        return function() {
          return option.error && option.error('データが読み込めませんでした');
        };
      })(this),
      success: (function(_this) {
        return function(data) {
          return option.success && option.success(data);
        };
      })(this)
    });
  },
  initGeoJSON: function(major) {
    return this.loadGeoJSON({
      major: major,
      success: (function(_this) {
        return function(data) {
          var geojson, level, levels, _ref;
          _this.geojsons = data.geojson;
          levels = [];
          _ref = data.geojson;
          for (level in _ref) {
            geojson = _ref[level];
            levels.push(level);
          }
          map.loadFloorByLevel(levels[0]);
          return map.createLevelMenu(levels.reverse());
        };
      })(this),
      error: function(message) {
        return alert(message);
      }
    });
  }
};

app.initGeoJSON(101);

setTimeout(function() {
  return map.createUserLocation(164);
}, 1000);

setTimeout(function() {
  return map.createUserLocation(165);
}, 2000);

setTimeout(function() {
  return map.createUserLocation(166);
}, 3000);

/*
//@ sourceMappingURL=app.map
*/
